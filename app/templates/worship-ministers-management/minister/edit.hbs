{{ page-title "Bekijk en bewerk : " @model.minister.ministerPosition.function.label " " @model.person.gebruikteVoornaam " " @model.person.achternaam }}
<AuToolbar @border="bottom" @size="large" as |Group|>
  <Group>
    <div>
      <AuHeading @skin="2">Bewerk bedienaar</AuHeading>
      <p class="au-u-h3">
        {{#if @model.minister.ministerPosition.function}}
          {{@model.minister.ministerPosition.function.label}},
        {{/if}}
        {{@model.person.gebruikteVoornaam}}
        {{@model.person.achternaam}}
      </p>
    </div>
  </Group>

  <Group>
    <AuButtonGroup>
      <AuButton
        @disabled={{this.save.isRunning}}
        @loading={{this.save.isRunning}}
        {{on "click" (perform this.save)}}
      >
        Wijzigingen opslaan
      </AuButton>
      <AuLink
        @route="worship-ministers-management"
        @skin="button-secondary"
      >
        Annuleer
      </AuLink>
    </AuButtonGroup>
  </Group>
</AuToolbar>

<div class="au-c-body-container">
  <div class="au-u-2-3@medium au-o-box">
    <div class="au-u-margin-bottom-small">
      <AuLabel for="worship-minister-function">Functienaam</AuLabel>
      <WorshipMinistersManagement::WorshipPositionSelector
          @options={{@model.ministerPosition}}
          @selected={{@model.minister.ministerPosition}}
      />
    </div>
    <div class="au-o-grid au-o-grid--tiny au-u-margin-bottom-small">
      <div class="au-o-grid__item au-u-1-2">
        <AuLabel for="worship-minister-correction-start-date">Startdatum</AuLabel>
        <AuDatePicker
          @value={{@model.minister.agentStartDate}}
          @onChange={{fn this.handleDateChange "agentStartDate"}}
          @id="worship-minister-correction-start-date"
        />
      </div>
      <div class="au-o-grid__item au-u-1-2">
        <AuLabel for="worship-minister-correction-end-date">Eindedatum</AuLabel>
        <AuDatePicker
          @value={{@model.minister.agentEndDate}}
          @onChange={{fn this.handleDateChange "agentEndDate"}}
          @id="worship-minister-correction-end-date"
        />
      </div>
    </div>
  </div>

  <AuHr @size="small" />
  <div class="au-o-box">
    <ContactInformationTable
      @contacts={{this.contactList}}
      @selectedContact={{this.selectedContact}}
      @editingContact={{this.editingContact}}
      @onAddNewContact={{this.addNewContact}}
      @onEditContact={{this.setEditingContact}}
      @onEditContactCancel={{this.handleEditContactCancel}}
      @onContactSelectionChange={{this.handleContactSelectionChange}}
    />

    {{#if
      (and
        this.editingContact.errors.telefoon
        this.editingContact.errors.adres
        this.editingContact.errors.email
      )
    }}
      <AuAlert
        @title={{this.title}}
        @skin="error"
        @icon="cross"
        @size="small"
        class="au-u-margin-top-small"
      >
        <p>
          Gelieve minstens het "Adres", "E-mail" of "Primair telefoonnummer"
          veld in te vullen.
        </p>
      </AuAlert>
    {{/if}}
  </div>
</div>

{{outlet}}
